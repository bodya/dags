drop table db_moex.test_marketdata_tb

CREATE TABLE IF NOT EXISTS db_moex.test_marketdata_tb (
	datestamp DateTime,
	secid String,
	boardid String,
	spread Float64,
	open Float64,
	high Float64,
	low Float64,
	last Float64,
	quantity UInt64,
	lastchange Float64,
	numtrades UInt64,
	voltoday UInt64,
	valtoday UInt64,
	valtoday_usd UInt64,
	updatetime String,
	lastchangeprcnt Float64,
	time String,
	seqnum UInt64,
	systime DateTime,
	oichange Int64
)
ENGINE = ReplacingMergeTree()
ORDER BY (secid, time, numtrades, oichange)
SETTINGS index_granularity = 8192

select count()
from db_moex.test

OPTIMIZE TABLE test DEDUPLICATE;